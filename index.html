<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>投胎模拟器 · v6 直觉加权版</title>
  <meta name="description" content="更直观的100分制：国家机会、家庭起点、公共服务、安全稳定、社会环境。支持十连抽与累计统计。纯前端，可部署到 GitHub Pages。" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <main class="container">
    <header class="hero">
      <h1>投胎模拟器 · v6 直觉加权版</h1>
      <p class="subtitle">评分= 国家机会35% + 家庭起点35% + 公共服务10% + 安全稳定15% + 社会环境5%。支持十连抽与累计统计。</p>
    </header>

    <section class="panel">
      <div class="controls">
        <label for="yearSelect">年份</label>
        <select id="yearSelect" class="select">
          <option value="1960">1960</option>
          <option value="1970">1970</option>
          <option value="1980">1980</option>
          <option value="1990">1990</option>
          <option value="2000">2000</option>
          <option value="2010">2010</option>
          <option value="2020">2020</option>
          <option value="2024">2024（近似用2023数据）</option>
        </select>

        <div class="btn-row">
          <button id="rollOnce" class="btn primary">投胎一次</button>
          <button id="rollTen" class="btn secondary">十连抽</button>
          <button id="clearStats" class="btn ghost">清空统计</button>
        </div>
      </div>

      <div id="status" class="status">首次加载会取数据（仅解析 8 个年份，适配手机）。</div>

      <div id="resultOnce" class="result-card hidden">
        <h2>本次结果</h2>
        <div class="result-line"><span class="label">国家 / 地区：</span><span id="rCountry"></span></div>
        <div class="result-line"><span class="label">性别：</span><span id="rGender"></span></div>
        <div class="result-line"><span class="label">家庭：</span><span id="rWealth"></span></div>
        <div class="result-line"><span class="label">人生难度：</span><span id="rTier"></span></div>
        <div class="result-line"><span class="label">综合评分：</span><span id="rScore"></span></div>
        <div class="result-line"><span class="label">本次组合概率：</span><span id="rComboProb"></span></div>
        <div class="big-emoji" id="rEmoji"></div>
        <div class="note" id="approxNote"></div>
      </div>

      <div id="resultTen" class="result-card hidden">
        <h2>十连抽结果</h2>
        <div id="tenList"></div>
        <div class="note" id="approxNote10"></div>
      </div>

      <div id="statsCard" class="result-card hidden">
        <h2>累计统计</h2>
        <div class="stats-grid">
          <div class="stat-box">
            <div class="stat-title">总抽取次数</div>
            <div class="stat-value" id="sTotal">0</div>
          </div>
          <div class="stat-box">
            <div class="stat-title">平均评分</div>
            <div class="stat-value" id="sAvg">0.0</div>
          </div>
        </div>

        <div class="table-wrap">
          <table id="tblDiff">
            <caption>人生难度占比</caption>
            <thead><tr><th>档位</th><th>次数</th><th>占比</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>

        <div class="table-wrap">
          <table id="tblWealth">
            <caption>家庭富裕占比</caption>
            <thead><tr><th>类别</th><th>次数</th><th>占比</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>

        <div class="table-wrap">
          <table id="tblScore">
            <caption>评分分布</caption>
            <thead><tr><th>区间</th><th>次数</th><th>占比</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <footer class="footer">
      <div>数据：
        <a target="_blank" href="https://ourworldindata.org/grapher/population.csv">Population</a> ·
        <a target="_blank" href="https://ourworldindata.org/grapher/crude-birth-rate.csv">Crude birth rate</a> ·
        <a target="_blank" href="https://ourworldindata.org/grapher/gdp-per-capita-worldbank.csv">GDP per capita (PPP)</a>
      </div>
      <div>中文国家名：内置完整 ISO3 → 中文映射；支持本地预处理数据 data/prebaked.json。</div>
      <div class="small">© 2025 Rebirth Simulator · 代码 MIT · 数据 CC BY 4.0（UN WPP/World Bank，经 OWID 整理）</div>
    </footer>
  </main>

  <script src="config.js"></script>
  <script src="app.js"></script>
</body>
</html>
